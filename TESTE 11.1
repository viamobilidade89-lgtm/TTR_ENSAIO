<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ALPHA HUB - SISTEMA DE ENSAIOS</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.25/jspdf.plugin.autotable.min.js"></script>

    <style>
        :root { 
            --cor-fundo: #0f172a; --cor-card: rgba(30, 41, 59, 0.98); --cor-primaria: #38bdf8; 
            --cor-megger: #f59e0b; --cor-micro: #10b981; --cor-texto: #f8fafc;
        }

        body { 
            font-family: 'Segoe UI', sans-serif; background: var(--cor-fundo); color: var(--cor-texto); margin: 0; padding: 15px;
            background-image: radial-gradient(circle at top right, #1e293b, #0f172a); background-attachment: fixed;
        }
        
        .container { max-width: 900px; margin: auto; }
        
        /* Dashboard Styles */
        .dashboard { display: grid; grid-template-columns: 1fr; gap: 20px; margin-top: 50px; }
        .btn-modulo { 
            padding: 30px; border-radius: 20px; border: 1px solid rgba(255,255,255,0.1);
            text-align: center; cursor: pointer; transition: 0.3s; background: rgba(255,255,255,0.05);
        }
        .btn-modulo:hover { transform: translateY(-5px); background: rgba(255,255,255,0.1); }
        .btn-modulo h2 { margin: 10px 0 0; }

        /* App Layout */
        .card { background: var(--cor-card); padding: 25px; border-radius: 20px; border: 1px solid rgba(255,255,255,0.1); position: relative; display: none; }
        .card.ativo { display: block; animation: fadeIn 0.4s; }

        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

        .tres-pontos { position: absolute; top: 20px; right: 20px; cursor: pointer; font-size: 28px; color: var(--cor-primaria); }

        .grade { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-bottom: 15px; }
        
        label { display: block; margin-top: 10px; font-weight: bold; font-size: 0.85em; color: var(--cor-primaria); text-transform: uppercase; }
        input, select { 
            width: 100%; padding: 12px; margin: 5px 0 10px; background: rgba(0,0,0,0.3); 
            border: 1px solid rgba(255,255,255,0.1); border-radius: 8px; color: inherit; box-sizing: border-box;
        }

        .btn-voltar { background: none; color: #94a3b8; border: 1px solid #475569; padding: 10px 20px; margin-bottom: 20px; border-radius: 8px; cursor: pointer; }
        .btn-calc { background: var(--cor-primaria); color: #000; width: 100%; padding: 15px; font-weight: bold; border-radius: 8px; border: none; cursor: pointer; }
        
        footer { text-align: center; margin-top: 30px; font-size: 0.8em; opacity: 0.5; }

        /* Gaveta */
        .gaveta { position: fixed; top: 0; right: -350px; width: 320px; height: 100%; background: #1e293b; border-left: 3px solid var(--cor-primaria); z-index: 1000; transition: 0.4s; padding: 20px; box-sizing: border-box; }
        .gaveta.ativa { right: 0; }
        .mascara { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.7); display: none; z-index: 999; }
    </style>
</head>
<body>

<div class="mascara" id="mascara" onclick="toggleMenu()"></div>

<div class="gaveta" id="gaveta">
    <h2 style="color:var(--cor-primaria)">‚öôÔ∏è Ajustes ALPHA</h2>
    <label>Novo T√©cnico</label>
    <div style="display:flex; gap:5px"><input type="text" id="nT"><button onclick="addDB('tecnicos','nT')">+</button></div>
    <label>Novo Local</label>
    <div style="display:flex; gap:5px"><input type="text" id="nL"><button onclick="addDB('locais','nL')">+</button></div>
    <button onclick="limparDB()" style="background:#ef4444; width:100%; margin-top:30px; color:#fff; border:none; padding:10px; border-radius:5px;">LIMPAR BANCO</button>
</div>

<div class="container">
    
    <div id="telaDashboard">
        <header style="text-align: center; margin-bottom: 40px;">
            <h1 style="color:var(--cor-primaria); margin:0;">ALPHA HUB</h1>
            <p>Selecione o ensaio que deseja realizar</p>
        </header>

        <div class="dashboard">
            <div class="btn-modulo" onclick="abrirModulo('moduloTTR')" style="border-left: 5px solid var(--cor-primaria);">
                <h2>üîÑ TTR</h2>
                <p>Rela√ß√£o de Transforma√ß√£o</p>
            </div>
            <div class="btn-modulo" onclick="abrirModulo('moduloMegger')" style="border-left: 5px solid var(--cor-megger);">
                <h2>‚ö° MEG√îMETRO</h2>
                <p>Resist√™ncia de Isolamento</p>
            </div>
            <div class="btn-modulo" onclick="abrirModulo('moduloMicro')" style="border-left: 5px solid var(--cor-micro);">
                <h2>üî¨ MICROOHM√çMETRO</h2>
                <p>Resist√™ncia de Contato</p>
            </div>
        </div>
    </div>

    <div id="moduloTTR" class="card">
        <button class="btn-voltar" onclick="voltarDash()">‚Üê Voltar</button>
        <div class="tres-pontos" onclick="toggleMenu()">&#8942;</div>
        <h1 style="color:var(--cor-primaria)">üîÑ Ensaios TTR</h1>
        
        <div class="grade">
            <div><label>Fasorial</label><select id="selFas" onchange="configTTR()"></select></div>
            <div><label>Temp. (¬∞C)</label><input id="tTTR" type="number" value="25"></div>
        </div>
        <div class="grade">
            <div><label>T√©cnico</label><select class="selTec"></select></div>
            <div><label>Local</label><select class="selLoc"></select></div>
        </div>

        <div id="inputsTTR" class="grade">
            </div>
        <button class="btn-calc" onclick="calcularTTR()">CALCULAR TTR</button>
    </div>

    <div id="moduloMegger" class="card">
        <button class="btn-voltar" onclick="voltarDash()">‚Üê Voltar</button>
        <h1 style="color:var(--cor-megger)">‚ö° Isolamento (Megger)</h1>
        <div class="grade">
            <div><label>Tens√£o Aplicada</label><select id="vMegger"><option>500V</option><option>1kV</option><option>2.5kV</option><option>5kV</option><option>10kV</option></select></div>
            <div><label>T√©cnico</label><select class="selTec"></select></div>
        </div>
        <div class="grade">
            <section>
                <label>R 30 seg (MŒ©)</label><input id="m30" type="number">
                <label>R 60 seg (MŒ©)</label><input id="m60" type="number">
                <label>R 10 min (GŒ©)</label><input id="m10" type="number">
            </section>
        </div>
        <p style="font-size: 0.8em; opacity: 0.7;">* C√°lculos de IP e IA ser√£o processados no relat√≥rio.</p>
        <button class="btn-calc" style="background:var(--cor-megger)" onclick="alert('M√≥dulo em constru√ß√£o - Dados salvos!')">CALCULAR ISOLAMENTO</button>
    </div>

    <div id="moduloMicro" class="card">
        <button class="btn-voltar" onclick="voltarDash()">‚Üê Voltar</button>
        <h1 style="color:var(--cor-micro)">üî¨ Resist√™ncia de Contato</h1>
        <div class="grade">
            <div><label>Corrente (A)</label><input type="number" value="100"></div>
            <div><label>T√©cnico</label><select class="selTec"></select></div>
        </div>
        <div class="grade">
            <section><label>Fase A (¬µŒ©)</label><input type="number"></section>
            <section><label>Fase B (¬µŒ©)</label><input type="number"></section>
            <section><label>Fase C (¬µŒ©)</label><input type="number"></section>
        </div>
        <button class="btn-calc" style="background:var(--cor-micro)" onclick="alert('M√≥dulo em constru√ß√£o - Dados salvos!')">CALCULAR CONTATO</button>
    </div>

    <footer>ALPHA TEAM ENGINEERING</footer>
</div>

<script>
    // Navega√ß√£o
    function abrirModulo(id) {
        document.getElementById('telaDashboard').style.display = 'none';
        document.querySelectorAll('.card').forEach(c => c.classList.remove('ativo'));
        document.getElementById(id).classList.add('ativo');
        carregarSelects();
    }

    function voltarDash() {
        document.getElementById('telaDashboard').style.display = 'block';
        document.querySelectorAll('.card').forEach(c => c.classList.remove('ativo'));
    }

    // Gaveta e DB
    function toggleMenu() {
        const g = document.getElementById('gaveta');
        g.classList.toggle('ativa');
        document.getElementById('mascara').style.display = g.classList.contains('ativa') ? 'block' : 'none';
    }

    function addDB(chave, id) {
        let v = document.getElementById(id).value;
        if(!v) return;
        let l = JSON.parse(localStorage.getItem('alpha_hub_'+chave) || "[]");
        l.push(v);
        localStorage.setItem('alpha_hub_'+chave, JSON.stringify(l));
        document.getElementById(id).value = "";
        carregarSelects();
    }

    function carregarSelects() {
        const tecs = JSON.parse(localStorage.getItem('alpha_hub_tecnicos') || "[]");
        const locs = JSON.parse(localStorage.getItem('alpha_hub_locais') || "[]");
        
        document.querySelectorAll('.selTec').forEach(s => {
            s.innerHTML = '<option>---</option>' + tecs.map(t => `<option>${t}</option>`).join("");
        });
        document.querySelectorAll('.selLoc').forEach(s => {
            s.innerHTML = '<option>---</option>' + locs.map(l => `<option>${l}</option>`).join("");
        });
    }

    // L√≥gica TTR (In√≠cio)
    const fasoriais = {
        "Dyn11": { h: ["H1-H3", "H2-H1", "H3-H2"], x: ["X0-X1", "X0-X2", "X0-X3"], kH: 1.5 },
        "Yyn0": { h: ["H1-H0", "H2-H0", "H3-H0"], x: ["X1-X0", "X2-X0", "X3-X0"], kH: 1.0 }
    };

    function configTTR() {
        const f = document.getElementById('selFas').value;
        const c = fasoriais[f];
        let html = '<section><h3>ALTA</h3>';
        c.h.forEach((n,i) => html += `<label>${n}</label><input id="h${i}" type="number">`);
        html += '</section><section><h3>BAIXA</h3>';
        c.x.forEach((n,i) => html += `<label>${n}</label><input id="x${i}" type="number">`);
        html += '</section>';
        document.getElementById('inputsTTR').innerHTML = html;
    }

    window.onload = () => {
        const s = document.getElementById('selFas');
        Object.keys(fasoriais).forEach(k => s.innerHTML += `<option>${k}</option>`);
        configTTR();
        carregarSelects();
    };

    function limparDB() { if(confirm("Limpar tudo?")) { localStorage.clear(); location.reload(); } }
</script>
</body>
</html>

